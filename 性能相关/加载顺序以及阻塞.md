## 文件加载顺序

### 一般网页加载流程

1. 浏览器一边下载`HTML`页面，一边进行解析
2. 解析过程中遇到`<script>`标签时，暂停解析网页渲染的控制权交给`javascript`引擎
3. 如果`<script>`标签引用了外部脚本，就下载该脚本，否则立即执行
4. 执行完毕后，将控制权交回渲染引擎。

产生第二点的原因，与浏览器的线程相关。浏览器中存在`GUI`渲染线程以及`Javascript`引擎线程，两者时互斥的，只能同时执行一个，因为`javascript`语言能够操控`HTML`的标签，一旦同时进行，可能会产生出错。

也因为这点，可能会导致页面的阻塞，当下载`javascript`文件时，是不会对网页进行渲染的，这将导致网页会有空白页。这点可以通过`defer`或者`async`属性进行解决



### `javascript`执行的依赖

`javascript`的执行依赖前面的样式。即只有前面的样式全部下载完成后才会执行`javascript`，但是此时外链`css`和外链`javascript`是并行下载的。

`css`需要分块，首页的`css`独立，其余的`css`需要动态加载，因为`html`的绘制会被`css`阻塞，这样可以减少首次进入时的白屏时间。

### `defer`

`defer`作用是并行加载`javascript`，到页面解析完成后才会执行，按顺序执行

在解析过程中遇到`defer`属性的`javascript`外链脚本是，直接进行下载，并继续解析`HTML`文件，直到解析完成后再执行`javascript`脚本



### `async`

`async`作用是异步加载`javascript`，不依赖于任何`js`和`css`的执行，再下载完成后立刻执行，不能保证按顺序执行。