## `HTTPS`详解

### 目的

`HTTPS`源于`HTTP`,主要是为了解决`HTTP`的安全性问题，在`HTTP`中，传输时的数据包是明文传输，所有用户的资料和密码都会直接暴露出来，而`HTTPS`就是在传输的过程中进行了加密。在原本的`HTTP`协议基础上，再加入了一层`SSL or TLS`。使得本来的`HTTP`+`TCP`+`IP`变为`HTTP`+`SSL or TLS`+`TCP`+`IP`。



### 访问过程

#### HTTP访问过程

1. 客户端向服务器**发出请求**
2. 服务器接收到请求后进行**响应**
3. 连接完成，客户端发送数据。



#### 演化过程

因为`HTTP`协议传输数据时时明文传输，所以在传输过程中可能会被劫持。也就是存在黑客假冒成服务器进行传输。

也因为存在这种风险，所以采取了加密的方式。

##### 对称加密

对称加密：只有一个密钥的加密方式，例如 `AES`,`DES`等

通过采取对称加密，将传输的数据进行加密，这样就能避免被劫持。



##### 非对称加密

但是采用对称加密会导致服务器的密钥会存有大量密钥，导致维护密钥的成本太大。所以采用了非对称加密。

非对称加密：密钥分为私钥和公钥的加密方式。例如`RSA`

客户端用服务器的公钥进行加密数据，服务器用客户端的私钥进行响应。

但是这种方式有缺陷：因为公钥是服务器公开的，所以黑客可以截取服务器发送到客户端的数据包进行解密。这样也会导致数据泄露。



##### 结合两者

因为两种方式都存在优缺点，所以可以将其结合。

服务器端在第一次响应时，将**非对称密码的公钥**发送给客户端；然后客户端通过公钥加密自己所使用的**对称密码的密钥**发送给服务器。以后的所有通信就能使用对称密码进行。

这样的话就能除去两种加密方式的缺点。

只要解决最后一个问题就可以了：

**如何避免黑客假冒服务器。**



### `SSL`证书

`SSL`证书包括

1. 证书的发布机构CA
2. 证书的有效期
3. 公钥
4. 证书所有者
5. 签名

证书会在第一次响应时发送到客户端，这样就能避免被黑客假冒。

### `HTTPS`全过程

1. 客户端请求服务器获取证书，公钥
2. 客户端接受证书并解析
3. 生成随机值
4. 用公钥加密随机值传输到服务器
5. 服务器解密后将随机值，并与内容加密传输会客户端
6. 客户端验证服务器身份后将对称密码算法和密钥传输到服务器
7. 并以后与服务器通过对称密码算法进行加密传输

